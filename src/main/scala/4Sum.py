from collections import defaultdict

class Solution:
    def fourSum(self, nums, target):
        m = defaultdict(list)
        #get all product
        for i in range(len(nums)):
            for j in range(len(nums)):
                if i == j:
                    continue
                m[nums[i] + nums[j]].append(sorted([i, j]))
        res = set()
        for s,lst in m.items():
            exp = target - s
            if exp in m:
                for i1,j1 in m[s]:
                    for i2,j2 in m[exp]:
                        if i1 == i2 or i1 == j2 or i2 == j1 or j2 == j1:
                            continue
                        l = tuple(sorted([nums[i1], nums[j1],nums[i2], nums[j2]]))
                        res.add(l)
        return [[lst[0], lst[1], lst[2], lst[3] ] for lst in list(res)]


sol = Solution()
print(sol.fourSum([-494,-474,-425,-424,-391,-371,-365,-351,-345,-304,-292,-289,-283,-256,-236,-236,-236,-226,-225,-223,-217,-185,-174,-163,-157,-148,-145,-130,-103,-84,-71,-67,-55,-16,-13,-11,1,19,28,28,43,48,49,53,78,79,91,99,115,122,132,154,176,180,185,185,206,207,272,274,316,321,327,327,346,380,386,391,400,404,424,432,440,463,465,466,475,486,492],-1211))
#print(sol.fourSum([-3,-2,-1,0,0,1,2,3],0))
#print(sol.fourSum([-497,-488,-484,-462,-453,-422,-402,-378,-371,-362,-345,-342,-332,-301,-290,-257,-239,-229,-205,-175,-98,-92,-90,-87,-73,-67,-63,-61,-40,-37,-36,-32,-16,-10,0,33,45,53,110,110,130,147,174,194,207,218,221,247,249,260,273,278,311,323,335,356,357,371,421,432,455,482,487], 4941))
#print(sol.fourSum([-463,-428,-392,-386,-348,-312,-280,-248,-247,-244,-224,
#                   -216,-198,-195,-195,-189,-175,-173,-167,-155,-111,-96,-36,-28,-3,10,15,22,25,44,44,49,50,68,84,88,104,107,111,116,171,208,233,304,309,313,318,323,330,331,331,358,364,365,388,396,403,425,449], 2110))
#print(sol.fourSum([0,0,0,0], 0))
print(sol.fourSum([1, 0, -1, 0, -2, 2], 0))


